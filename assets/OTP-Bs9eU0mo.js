import{c as p,t as m,r as c,p as O,j as e,H as v,B as f,l as T}from"./index-BV6FT8Uv.js";import{I as N}from"./input-uq7BhVoG.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],S=p("rotate-ccw",P);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],k=p("shield-check",C),x="http://localhost:5000/api",I=async(r,s,a,n,o)=>{a(!0),n("");try{const t=await fetch(`${x}/verify-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,otp:s})}),i=await t.json();if(!t.ok)throw new Error(i.message||"Invalid OTP");m.success(i.message||"OTP Verified!"),o(!0)}catch(t){m.error(t.message||"Failed to verify OTP"),n(t.message||"Something went wrong")}finally{a(!1)}},R=async(r,s)=>{try{const a=await fetch(`${x}/resend-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}),n=await a.json();if(!a.ok){s(n.message||"Failed to resend OTP");return}m.success(n.message||"OTP resent successfully!")}catch(a){s(a.message||"Server error during OTP resend")}},F=({email:r})=>{const[s,a]=c.useState(""),[n,o]=c.useState(""),[t,i]=c.useState(!1),[l,u]=c.useState(30),[y,g]=c.useState(!1),j=O(),w=async d=>{if(d.preventDefault(),!s.trim()){o("OTP is required");return}if(!/^\d{4,6}$/.test(s.trim())){o("Invalid OTP format");return}await I(r,s,i,o,g)},b=async()=>{l>0||(i(!0),await R(r,o),u(30),i(!1))};return c.useEffect(()=>{const d=setInterval(()=>{u(h=>h>0?h-1:0)},1e3);return()=>clearInterval(d)},[]),y&&setTimeout(()=>j("/reset-password",{state:{email:r}}),1e3),e.jsxs(e.Fragment,{children:[e.jsx(v,{children:e.jsx("title",{children:"Fenzo | OTP"})}),e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-12 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"flex items-center justify-center mb-6",children:[e.jsx(k,{className:"w-6 h-6 text-orange-600 mr-2"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 text-center",children:"Verify OTP"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 mb-1",children:"Enter OTP sent to your email"}),e.jsx(N,{id:"otp",type:"text",name:"otp",placeholder:"4 or 6 digit code",value:s,onChange:d=>a(d.target.value),className:`w-full px-4 py-3 rounded-lg border ${n?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-orange-500 transition`,disabled:t,autoComplete:"one-time-code",maxLength:6,error:n&&n})]}),e.jsx(f,{type:"submit",disabled:t,className:`w-full py-3 px-4 rounded-lg bg-orange-600 hover:bg-orange-700 text-white font-medium flex items-center justify-center transition ${t?"opacity-70 cursor-not-allowed":""}`,children:t?e.jsx(T,{className:"animate-spin h-5 w-5"}):"Verify OTP"})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs(f,{type:"Button",onClick:b,disabled:l>0||t,className:"text-sm font-medium text-orange-600 hover:underline flex items-center justify-center gap-1 disabled:opacity-50",children:[e.jsx(S,{size:16}),l>0?`Resend in ${l}s`:"Resend OTP"]})})]})})]})};export{F as default};
