import{x as Y,u as R,n as q,g as G,r as a,j as e,h as P,L as H,B as J}from"./index-wInRrqmW.js";import{f as K,P as M,C as Q,a as W,b as Z}from"./Orders-DIzcdDzO.js";import{C as D}from"./CustomSelect-Cyt2lC3y.js";import{I as v}from"./input-DRNPD7QG.js";import{X as V}from"./x-Dduk8zJw.js";import{T as ee}from"./truck-Ddw8bLRS.js";const _={delivered:"text-green-600 bg-green-100",processing:"text-orange-600 bg-orange-100",cancelled:"text-red-600 bg-red-100",pending:"text-gray-600 bg-gray-100",shipped:"text-blue-600 bg-blue-100",out_for_delivery:"text-purple-600 bg-purple-100"},te={delivered:e.jsx(Z,{size:18,className:"text-green-600"}),processing:e.jsx(P,{size:18,className:"animate-spin text-orange-600"}),cancelled:e.jsx(W,{size:18,className:"text-red-600"}),pending:e.jsx(Q,{size:18,className:"text-gray-600"}),shipped:e.jsx(ee,{size:18,className:"text-blue-600"}),out_for_delivery:e.jsx(M,{size:18,className:"text-purple-600"})},se=["All Status","Delivered","Processing","Cancelled","Pending","Shipped","Out For Delivery"],ae=["All Payments","Credit Card","PayPal","Debit Card"],re=["All Sort","Date ↑","Date ↓","Price ↑","Price ↓"],C=(r,s)=>{if(!s||s.includes("All"))return"";const c=s.toLowerCase().replace(/\s/g,"_");if(r==="status")return c in _?c:"";if(r==="sort")switch(s){case"Date ↑":return"date-asc";case"Date ↓":return"date-desc";case"Price ↑":return"total-asc";case"Price ↓":return"total-desc";default:return""}return s},d=(r,s)=>{if(!s)return r==="status"?"All Status":r==="payment"?"All Payments":r==="sort"?"All Sort":"";if(r==="status")return s.split("_").map(c=>c[0].toUpperCase()+c.slice(1)).join(" ");if(r==="sort")switch(s){case"date-asc":return"Date ↑";case"date-desc":return"Date ↓";case"total-asc":return"Price ↑";case"total-desc":return"Price ↓";default:return"All Sort"}return s},de=()=>{const{isLoggedIn:r}=Y(),[s,c]=R(),A=q(),F=G("token"),[L,T]=a.useState([]),[n,k]=a.useState(!1),[I,u]=a.useState(""),[x,g]=a.useState(s.get("search")||""),[i,f]=a.useState(s.get("dateFrom")||""),[m,h]=a.useState(s.get("dateTo")||""),[y,b]=a.useState(d("status",s.get("status"))),[j,N]=a.useState(d("payment",s.get("payment"))),[S,w]=a.useState(d("sort",s.get("sort")));a.useEffect(()=>{!r&&!F&&A("/login")},[r,F,A]);const O=a.useCallback(async t=>{k(!0);const l={};t.forEach((o,p)=>{o&&(l[p]=o)}),g(l.search||""),f(l.dateFrom||""),h(l.dateTo||""),b(d("status",l.status)),N(d("payment",l.payment)),w(d("sort",l.sort));try{const o=await K(l);T(o)}catch(o){console.error("Failed to fetch orders:",o),T([])}finally{k(!1)}},[]);a.useEffect(()=>{O(s)},[s,O]);const z=()=>{if(u(""),i&&m){const U=new Date(i),X=new Date(m);if(U>X){u("Start date cannot be after end date.");return}}const t={},l=C("status",y),o=C("payment",j),p=C("sort",S);x&&(t.search=x),l&&(t.status=l),o&&(t.payment=o),p&&(t.sort=p),i&&(t.dateFrom=i),m&&(t.dateTo=m),c(t,{replace:!0})},E=()=>{g(""),b("All Status"),N("All Payments"),w("All Sort"),f(""),h(""),u(""),c({},{replace:!0})},B=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",$=x||y!=="All Status"||j!=="All Payments"||S!=="All Sort"||i||m;return e.jsxs("div",{className:"p-4 sm:p-6 bg-gray-100 min-h-[50vh]",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-6",children:"Your Orders"}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6 items-start",children:[e.jsx(v,{type:"text",value:x,onChange:t=>g(t.target.value),placeholder:"Search Order...",className:"flex-1 min-w-[120px] sm:min-w-[150px] border border-gray-300 rounded px-3 py-2 text-sm focus:ring-1 focus:ring-orange-500 focus:border-orange-500"}),e.jsx("button",{onClick:z,disabled:n,className:"bg-orange-500 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors text-sm sm:text-base disabled:opacity-50",children:n?e.jsx(P,{className:"animate-spin h-5 w-5 mx-auto"}):"Apply"}),e.jsx(D,{placeholder:"All Status",options:se,selectedValue:y,onChange:b,isLoading:n,className:"flex-1 min-w-[120px] sm:min-w-[150px]"}),e.jsx(D,{placeholder:"All Payments",options:ae,selectedValue:j,onChange:N,isLoading:n,className:"flex-1 min-w-[120px] sm:min-w-[150px]"}),e.jsx(D,{placeholder:"All Sort",options:re,selectedValue:S,onChange:w,isLoading:n,className:"flex-1 min-w-[120px] sm:min-w-[150px]"}),e.jsx(v,{type:"date",value:i,max:new Date().toISOString().split("T")[0],onChange:t=>f(t.target.value),placeholder:"From Date",error:I,className:"flex-1 min-w-[120px] sm:min-w-[150px] border border-gray-300 rounded px-3 py-2 text-sm focus:ring-1 focus:ring-orange-500 focus:border-orange-500"}),e.jsx(v,{type:"date",value:m,max:new Date().toISOString().split("T")[0],onChange:t=>h(t.target.value),placeholder:"To Date",className:"flex-1 min-w-[120px] sm:min-w-[150px] border border-gray-300 rounded px-3 py-2 text-sm focus:ring-1 focus:ring-orange-500 focus:border-orange-500"}),e.jsxs("button",{onClick:E,disabled:n,className:"bg-gray-200 flex items-center text-gray-800 px-3 sm:px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors text-sm sm:text-base disabled:opacity-50",children:["Clear ",e.jsx(V,{size:18,className:"ml-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[n&&e.jsxs("div",{className:"col-span-full text-center py-10",children:[e.jsx(P,{className:"animate-spin h-8 w-8 text-orange-500 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Loading orders..."})]}),!n&&L.length===0&&e.jsx("p",{className:"col-span-full text-center text-gray-500 py-10",children:$?"No orders found matching your filters.":"You have no orders yet."}),!n&&L.map(t=>e.jsxs("div",{style:{boxShadow:"0 0 8px 2px rgba(0, 0, 0, 0.15)"},className:"bg-white rounded-xl p-4 sm:p-6 flex flex-col justify-between hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm lg:text-md text-gray-500",children:"Order ID"}),e.jsx("p",{className:"font-medium text-gray-800 text-base",children:t.id})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm lg:text-md text-gray-500",children:"Date"}),e.jsx("p",{className:"text-gray-800 text-base",children:B(t?.created_at)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm lg:text-md text-gray-500",children:"Total"}),e.jsxs("p",{className:"font-semibold text-gray-800 text-base",children:["$ ",parseFloat(t.total_amount||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm lg:text-md text-gray-500",children:"Payment"}),e.jsx("p",{className:"text-gray-800 text-base",children:t.payment_method})]}),e.jsxs("div",{className:"pt-2 flex justify-between items-center",children:[e.jsx("p",{className:"text-sm lg:text-md text-gray-500",children:"Status"}),e.jsxs("span",{className:`flex items-center gap-1 px-2 sm:px-3 py-1 rounded-full font-medium text-sm sm:text-base ${_[t.status.toLowerCase().replace(/\s/g,"_")]}`,children:[te[t.status.toLowerCase().replace(/\s/g,"_")]," ",t.status]})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(H,{to:`../order/${t?.id}`,children:e.jsx(J,{className:"bg-orange-500 cursor-pointer text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors text-sm sm:text-base w-full sm:w-auto",children:"View Details"})})})]},t.id))]})]})};export{de as default};
